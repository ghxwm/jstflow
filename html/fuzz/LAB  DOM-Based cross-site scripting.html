<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0049)http://127.0.0.1/WebGoat/attack?Screen=7&menu=400 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<title>LAB: DOM-Based cross-site scripting</title>
<link rel="stylesheet" href="./LAB  DOM-Based cross-site scripting_files/webgoat.css" type="text/css">
<link rel="stylesheet" href="./LAB  DOM-Based cross-site scripting_files/lesson.css" type="text/css">
<link rel="stylesheet" href="./LAB  DOM-Based cross-site scripting_files/menu.css" type="text/css">
<link rel="stylesheet" href="./LAB  DOM-Based cross-site scripting_files/layers.css" type="text/css">
<script language="JavaScript1.2" src="./LAB  DOM-Based cross-site scripting_files/javascript.js" type="text/javascript"></script>
<script language="JavaScript1.2" src="./LAB  DOM-Based cross-site scripting_files/menu_system.js" type="text/javascript"></script>
<script language="JavaScript1.2" src="./LAB  DOM-Based cross-site scripting_files/lessonNav.js" type="text/javascript"></script>
<script language="JavaScript1.2" src="./LAB  DOM-Based cross-site scripting_files/makeWindow.js" type="text/javascript"></script>
<script language="JavaScript1.2" src="./LAB  DOM-Based cross-site scripting_files/toggle.js" type="text/javascript"></script>
</head>

<body class="page" onload="setMenuMagic1(10,40,10,&#39;menubottom&#39;,&#39;menu5&#39;,&#39;submenu5&#39;,&#39;mbut5&#39;,&#39;menu100&#39;,&#39;submenu100&#39;,&#39;mbut100&#39;,&#39;menu200&#39;,&#39;submenu200&#39;,&#39;mbut200&#39;,&#39;menu400&#39;,&#39;submenu400&#39;,&#39;mbut400&#39;,&#39;menu500&#39;,&#39;submenu500&#39;,&#39;mbut500&#39;,&#39;menu600&#39;,&#39;submenu600&#39;,&#39;mbut600&#39;,&#39;menu700&#39;,&#39;submenu700&#39;,&#39;mbut700&#39;,&#39;menu800&#39;,&#39;submenu800&#39;,&#39;mbut800&#39;,&#39;menu900&#39;,&#39;submenu900&#39;,&#39;mbut900&#39;,&#39;menu1000&#39;,&#39;submenu1000&#39;,&#39;mbut1000&#39;,&#39;menu1100&#39;,&#39;submenu1100&#39;,&#39;mbut1100&#39;,&#39;menu1200&#39;,&#39;submenu1200&#39;,&#39;mbut1200&#39;,&#39;menu1300&#39;,&#39;submenu1300&#39;,&#39;mbut1300&#39;,&#39;menu1400&#39;,&#39;submenu1400&#39;,&#39;mbut1400&#39;,&#39;menu1500&#39;,&#39;submenu1500&#39;,&#39;mbut1500&#39;,&#39;menu1600&#39;,&#39;submenu1600&#39;,&#39;mbut1600&#39;,&#39;menu1700&#39;,&#39;submenu1700&#39;,&#39;mbut1700&#39;,&#39;menu1800&#39;,&#39;submenu1800&#39;,&#39;mbut1800&#39;,&#39;menu1900&#39;,&#39;submenu1900&#39;,&#39;mbut1900&#39;,&#39;menu3000&#39;,&#39;submenu3000&#39;,&#39;mbut3000&#39;);trigMM1url(&#39;menu&#39;,1);MM_preloadImages(&#39;images/buttons/hintLeftOver.jpg&#39;,&#39;images/buttons/hintOver.jpg&#39;,&#39;images/buttons/hintRightOver.jpg&#39;,&#39;images/buttons/paramsOver.jpg&#39;,&#39;images/buttons/htmlOver.jpg&#39;,&#39;images/buttons/cookiesOver.jpg&#39;,&#39;images/buttons/javaOver.jpg&#39;,&#39;images/buttons/plansOver.jpg&#39;,&#39;images/buttons/logout.jpg&#39;,&#39;images/buttons/helpOver.jpg&#39;); initIframe();">

	<div id="wrap">
	
		<div id="menu5" style="position:absolute; left:30px; top:140px; width:160px; z-index:105"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu5&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut5" border="0" alt="">Introduction</a></div>
		
		<div id="menu100" style="position: absolute; left: 30px; top: 153px; width: 160px; z-index: 106;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu100&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut100" border="0" alt="">General</a></div>
		
		<div id="menu200" style="position: absolute; left: 30px; top: 166px; width: 160px; z-index: 107;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu200&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut200" border="0" alt="">Access Control Flaws</a></div>
		
		<div id="menu400" style="position: absolute; left: 30px; top: 179px; width: 160px; z-index: 108;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu400&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1_open.gif" width="1" height="1&quot;20&quot;" name="mbut400" border="0" alt="">AJAX Security</a></div>
		
		<div id="menu500" style="position: absolute; left: 30px; top: 439px; width: 160px; z-index: 109;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu500&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut500" border="0" alt="">Authentication Flaws</a></div>
		
		<div id="menu600" style="position: absolute; left: 30px; top: 452px; width: 160px; z-index: 110;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu600&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut600" border="0" alt="">Buffer Overflows</a></div>
		
		<div id="menu700" style="position: absolute; left: 30px; top: 465px; width: 160px; z-index: 111;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu700&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut700" border="0" alt="">Code Quality</a></div>
		
		<div id="menu800" style="position: absolute; left: 30px; top: 478px; width: 160px; z-index: 112;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu800&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut800" border="0" alt="">Concurrency</a></div>
		
		<div id="menu900" style="position: absolute; left: 30px; top: 491px; width: 160px; z-index: 113;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu900&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut900" border="0" alt="">Cross-Site Scripting (XSS)</a></div>
		
		<div id="menu1000" style="position: absolute; left: 30px; top: 504px; width: 160px; z-index: 114;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1000&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1000" border="0" alt="">Denial of Service</a></div>
		
		<div id="menu1100" style="position: absolute; left: 30px; top: 517px; width: 160px; z-index: 115;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1100&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1100" border="0" alt="">Improper Error Handling</a></div>
		
		<div id="menu1200" style="position: absolute; left: 30px; top: 530px; width: 160px; z-index: 116;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1200&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1200" border="0" alt="">Injection Flaws</a></div>
		
		<div id="menu1300" style="position: absolute; left: 30px; top: 543px; width: 160px; z-index: 117;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1300&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1300" border="0" alt="">Insecure Communication</a></div>
		
		<div id="menu1400" style="position: absolute; left: 30px; top: 556px; width: 160px; z-index: 118;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1400&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1400" border="0" alt="">Insecure Configuration</a></div>
		
		<div id="menu1500" style="position: absolute; left: 30px; top: 569px; width: 160px; z-index: 119;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1500&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1500" border="0" alt="">Insecure Storage</a></div>
		
		<div id="menu1600" style="position: absolute; left: 30px; top: 582px; width: 160px; z-index: 120;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1600&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1600" border="0" alt="">Parameter Tampering</a></div>
		
		<div id="menu1700" style="position: absolute; left: 30px; top: 595px; width: 160px; z-index: 121;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1700&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1700" border="0" alt="">Session Management Flaws</a></div>
		
		<div id="menu1800" style="position: absolute; left: 30px; top: 608px; width: 160px; z-index: 122;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1800&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1800" border="0" alt="">Web Services</a></div>
		
		<div id="menu1900" style="position: absolute; left: 30px; top: 621px; width: 160px; z-index: 123;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu1900&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut1900" border="0" alt="">Admin Functions</a></div>
		
		<div id="menu3000" style="position: absolute; left: 30px; top: 634px; width: 160px; z-index: 124;"><a href="javascript:;" onclick="trigMenuMagic1(&#39;menu3000&#39;,1);return false" onfocus="if(this.blur)this.blur()"><img src="./LAB  DOM-Based cross-site scripting_files/1x1.gif" width="1" height="1&quot;20&quot;" name="mbut3000" border="0" alt="">Challenge</a></div>
		    
		<div id="submenu5" class="pviimenudiv" style="position: absolute; left: -150px; top: 140px; width: 150px; visibility: visible; z-index: 125;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=51&menu=5">How to work with WebGoat</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=6&menu=5">Tomcat Configuration</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=3&menu=5">Useful Tools</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=65&menu=5">Create a WebGoat Lesson</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu100" class="pviimenudiv" style="position: absolute; left: -150px; top: 153px; width: 150px; visibility: visible; z-index: 126;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=30&menu=100">Http Basics</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=2&menu=100">HTTP Splitting</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu200" class="pviimenudiv" style="position: absolute; left: -150px; top: 166px; width: 150px; visibility: visible; z-index: 127;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=11&menu=200">Using an Access Control Matrix</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=17&menu=200">Bypass a Path Based Access Control Scheme</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=37&menu=200">LAB: Role Based Access Control</a></td>
	    		</tr>
	    		
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=37&menu=200&stage=1">Stage 1: Bypass Business Layer Access Control</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=37&menu=200&stage=2">Stage 2: Add Business Layer Access Control</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=37&menu=200&stage=3">Stage 3: Bypass Data Layer Access Control</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=37&menu=200&stage=4">Stage 4: Add Data Layer Access Control</a>
						</td></tr>
				
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=18&menu=200">Remote Admin Access</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu400" class="pviimenudiv" style="position: absolute; left: 40px; top: 192px; width: 150px; visibility: visible; z-index: 128;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="./LAB  DOM-Based cross-site scripting_files/LAB  DOM-Based cross-site scripting.html">LAB: DOM-Based cross-site scripting</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=15&menu=400">LAB: Client Side Filtering</a></td>
	    		</tr>
	    		
<tr>
	      		<td><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=62&menu=400">Same Origin Policy Protection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=63&menu=400">DOM Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=20&menu=400">XML Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=69&menu=400">JSON Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=40&menu=400">Silent Transactions Attacks</a></td>
	    		</tr>
	    		
<tr>
	      		<td><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=35&menu=400">Dangerous Use of Eval</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=68&menu=400">Insecure Client Storage</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu500" class="pviimenudiv" style="position: absolute; left: -150px; top: 192px; width: 150px; visibility: visible; z-index: 129;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=36&menu=500">Password Strength</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=28&menu=500">Forgot Password</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=55&menu=500">Basic Authentication</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=23&menu=500">Multi Level Login 1</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=52&menu=500">Multi Level Login 2</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu600" class="pviimenudiv" style="position: absolute; left: -150px; top: 205px; width: 150px; visibility: visible; z-index: 130;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=8&menu=600">Buffer Overflow</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu700" class="pviimenudiv" style="position: absolute; left: -150px; top: 218px; width: 150px; visibility: visible; z-index: 131;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=61&menu=700">Discover Clues in the HTML</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu800" class="pviimenudiv" style="position: absolute; left: -150px; top: 231px; width: 150px; visibility: visible; z-index: 132;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=41&menu=800">Thread Safety Problems</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=29&menu=800">Shopping Cart Concurrency Flaw</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu900" class="pviimenudiv" style="position: absolute; left: -150px; top: 244px; width: 150px; visibility: visible; z-index: 133;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=13&menu=900">Phishing with XSS</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900">LAB: Cross Site Scripting</a></td>
	    		</tr>
	    		
			    		<tr><td class="pviimenudivstage"><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=1">Stage 1: Stored XSS</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=2">Stage 2: Block Stored XSS using Input Validation</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=3">Stage 3: Stored XSS Revisited</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=4">Stage 4: Block Stored XSS using Output Encoding</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><img src="./LAB  DOM-Based cross-site scripting_files/lessonComplete.jpg"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=5">Stage 5: Reflected XSS</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=33&menu=900&stage=6">Stage 6: Block Reflected XSS</a>
						</td></tr>
				
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=50&menu=900">Stored XSS Attacks</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=9&menu=900">Cross Site Request Forgery (CSRF)</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=49&menu=900">Reflected XSS Attacks</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=12&menu=900">HTTPOnly Test</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=64&menu=900">Cross Site Tracing (XST) Attacks</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1000" class="pviimenudiv" style="position: absolute; left: -150px; top: 257px; width: 150px; visibility: visible; z-index: 134;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=25&menu=1000">Denial of Service from Multiple Logins</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1100" class="pviimenudiv" style="position: absolute; left: -150px; top: 270px; width: 150px; visibility: visible; z-index: 135;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=60&menu=1100">Fail Open Authentication Scheme</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1200" class="pviimenudiv" style="position: absolute; left: -150px; top: 283px; width: 150px; visibility: visible; z-index: 136;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=21&menu=1200">Command Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=27&menu=1200">Blind SQL Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=67&menu=1200">Numeric SQL Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=66&menu=1200">Log Spoofing</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=4&menu=1200">XPATH Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=54&menu=1200">LAB: SQL Injection</a></td>
	    		</tr>
	    		
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=54&menu=1200&stage=1">Stage 1: String SQL Injection</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=54&menu=1200&stage=2">Stage 2: Parameterized Query #1</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=54&menu=1200&stage=3">Stage 3: Numeric SQL Injection</a>
						</td></tr>
				
			    		<tr><td class="pviimenudivstage"><a href="http://127.0.0.1/WebGoat/attack?Screen=54&menu=1200&stage=4">Stage 4: Parameterized Query #2</a>
						</td></tr>
				
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=58&menu=1200">String SQL Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=26&menu=1200">Database Backdoors </a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1300" class="pviimenudiv" style="position: absolute; left: -150px; top: 296px; width: 150px; visibility: visible; z-index: 137;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=39&menu=1300">Insecure Login</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1400" class="pviimenudiv" style="position: absolute; left: -150px; top: 309px; width: 150px; visibility: visible; z-index: 138;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=59&menu=1400">Forced Browsing</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1500" class="pviimenudiv" style="position: absolute; left: -150px; top: 322px; width: 150px; visibility: visible; z-index: 139;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=24&menu=1500">Encoding Basics</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1600" class="pviimenudiv" style="position: absolute; left: -150px; top: 335px; width: 150px; visibility: visible; z-index: 140;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=53&menu=1600">Exploit Hidden Fields</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=5&menu=1600">Exploit Unchecked Email</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=31&menu=1600">Bypass Client Side JavaScript Validation</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1700" class="pviimenudiv" style="position: absolute; left: -150px; top: 348px; width: 150px; visibility: visible; z-index: 141;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=56&menu=1700">Hijack a Session</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=57&menu=1700">Spoof an Authentication Cookie</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=16&menu=1700">Session Fixation</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1800" class="pviimenudiv" style="position: absolute; left: -150px; top: 361px; width: 150px; visibility: visible; z-index: 142;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=32&menu=1800">Create a SOAP Request</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=38&menu=1800">WSDL Scanning</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=10&menu=1800">Web Service SAX Injection</a></td>
	    		</tr>
	    		
<tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=22&menu=1800">Web Service SQL Injection</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu1900" class="pviimenudiv" style="position: absolute; left: -150px; top: 374px; width: 150px; visibility: visible; z-index: 143;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=44&menu=1900">Report Card</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>    
		<div id="submenu3000" class="pviimenudiv" style="position: absolute; left: -150px; top: 387px; width: 150px; visibility: visible; z-index: 144;">
	  		<table width="150" border="0" cellspacing="6" cellpadding="0"><tbody><tr>
	      		<td><a href="http://127.0.0.1/WebGoat/attack?Screen=14&menu=3000">The CHALLENGE!</a></td>
	    		</tr>
	    		

	  		</tbody></table>
		</div>
		<div id="top"></div>
		<div id="topRight">
	  		<div align="right"><a href="http://127.0.0.1/WebGoat/attack?action=Logout" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;logout&#39;,&#39;&#39;,&#39;images/buttons/logoutOver.jpg&#39;,1)"><img src="./LAB  DOM-Based cross-site scripting_files/logout.jpg" alt="LogOut" name="logout" width="45" height="22" border="0" id="logout"></a>  <a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400#getFAQ()" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage(&#39;help&#39;,&#39;&#39;,&#39;images/buttons/helpOver.jpg&#39;,1)"><img src="./LAB  DOM-Based cross-site scripting_files/help.jpg" alt="Help" name="help" width="22" height="22" border="0" id="help"></a></div>
		</div>
			<div id="lessonTitle" align="right">LAB: DOM-Based cross-site scripting</div>
			<div id="hMenuBar">
				
				<a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&show=PreviousHint" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;hintLeft&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;hintLeft&#39;,&#39;images/buttons/hintLeftOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/hintLeft.jpg" alt="Previous Hint" name="hintLeft" width="20" height="20" border="0" id="hintLeft">
				</a>
				<a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&show=NextHint" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;hint&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;hint&#39;,&#39;images/buttons/hintOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/hint.jpg" alt="Hints" name="hint" width="35" height="20" border="0" id="hint">
				</a>
				<a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&show=NextHint" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;hintRight&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;hintRight&#39;,&#39;images/buttons/hintRightOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/hintRight.jpg" alt="Next Hint" name="hintRight" width="20" height="20" border="0" id="hintRight">
				</a>
				
				<a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&show=Params" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;params&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;params&#39;,&#39;images/buttons/paramsOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/params.jpg" alt="Show Params" name="attack?Screen=7&amp;menu=400&amp;show=Params" width="87" height="20" border="0" id="params">
				</a>
				<a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&show=Cookies" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;cookies&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;cookies&#39;,&#39;images/buttons/cookiesOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/cookies.jpg" alt="Show Cookies" name="cookies" width="99" height="20" border="0" id="cookies">
				</a>
				<a href="javascript:toggle('lessonPlans')" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;plans&#39;,&#39;&#39;,1)" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;plans&#39;,&#39;images/buttons/plansOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/plans.jpg" alt="Lesson Plans" width="89" height="20" border="0" id="plans">
				</a>
				
				<a href="http://127.0.0.1/WebGoat/source" onclick="makeWindow(this.href+ &#39;?source=true&#39;, &#39;Java Source&#39;);return false;" target="javaWin" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;java&#39;,&#39;images/buttons/javaOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/java.jpg" alt="Show Java" name="java" width="75" height="20" border="0" id="java">
				</a>
				<a href="http://127.0.0.1/WebGoat/source" onclick="makeWindow(this.href + &#39;?solution=true&#39;, &#39;Java Solution&#39;);return false;" target="javaWin" onmouseover="MM_nbGroup(&#39;over&#39;,&#39;solutions&#39;,&#39;images/buttons/solutionsOver.jpg&#39;,&#39;&#39;,1)" onmouseout="MM_nbGroup(&#39;out&#39;)">
				<img src="./LAB  DOM-Based cross-site scripting_files/solutions.jpg" alt="Show Solution" name="solutions" width="73" height="20" border="0" id="solutions">
				</a>
				
								
			</div>
			<div id="twoCol">
	 	 	<div id="menuSpacer"></div>
	 	 	<div id="lessonArea">
	 	 	
			    	<div id="training_wrap">
			    	<div id="training" class="info"><a href="http://yehg.net/lab/pr0js/training/webgoat.php">Solution Videos</a></div>
			    	<div id="reset" class="info"><a href="http://127.0.0.1/WebGoat/attack?Screen=7&menu=400&Restart=7">Restart this Lesson</a></div>
			    	</div>
	    			
				
				<div id="lessonContent">STAGE 1:	For this exercise, your mission is to deface this website using the image at the following location: <a href="http://127.0.0.1/WebGoat/images/logos/owasp.jpg">OWASP IMAGE</a></div>
				<div id="message" class="info"></div>
	
			
			<div id="lessonContent"><form accept-charset="UNKNOWN" method="POST" name="form" action="./LAB  DOM-Based cross-site scripting_files/LAB  DOM-Based cross-site scripting.html" enctype="" onSubmit='return false;'>
<script src="./LAB  DOM-Based cross-site scripting_files/DOMXSS.js" language="JavaScript"></script><script src="./LAB  DOM-Based cross-site scripting_files/escape.js" language="JavaScript"></script><h1 id="greeting"></h1>Enter your name: <input value="" onkeyup="displayGreeting(person.value)" name="person" type="TEXT"><br><br><input name="SUBMIT" type="SUBMIT" value="Submit Solution">
</form></div>
			
				<div id="credits">
		  		<table align="RIGHT" cellspacing="0" width="90%" border="0" cellpadding="0">
	<tbody><tr>
		<td valign="MIDDLE" width="100%" align="RIGHT">
			
		</td>
		<td valign="MIDDLE" align="RIGHT"><a href="http://www.aspectsecurity.com/"><img hspace="0" vspace="0" border="0" alt="Aspect Security" src="./LAB  DOM-Based cross-site scripting_files/aspect.jpg"></a></td>
	</tr>
</tbody></table>

		  		</div>
			</div>
	  	</div>

		<div id="bottom">
			<div align="center"><a href="http://www.owasp.org/">OWASP Foundation</a> | 
								<a href="http://www.owasp.org/index.php/OWASP_WebGoat_Project">Project WebGoat</a> | 
								<a href="mailto: WebGoat@owasp.org?subject=WebGoat%20Bug%20Report%20-%20Lesson:%20%20DOMXSS">Report Bug</a>
			</div>
	  	</div>
	</div>


<iframe style="position: absolute; visibility: hidden; left: 275px; top: 145px; width: 474px;"></iframe><div id="lessonPlans" style="visibility:hidden; height:1px; position:absolute; left:260px; top:130px; width:425px; z-index:105;"><div align="Center">
<p><b>Lesson Plan Title: </b>DOM Based Cross Site Scripting (XSS)</p>
</div>
<p><b>Concept / Topic To Teach:</b> </p>
<!-- Start Instructions -->
The Document Object Model (DOM) presents an interesting problem from
a security standpoint.  It allows the content of a web page to be dynamically
modified, but that can be abused by attackers during a malicious code injection.  XSS,
a type of malicious code injection, can occur when unvalidated user input is used directly
to modify the content of a page on the client side.
<!-- Stop Instructions -->
<p><b>General Goal(s):</b> </p>
For this exercise, your mission is to use this vulnerability to inject
malicious code into the DOM.  Then in the last stage, you will correct
the flaws in the code to address the vulnerability.

				<br>
				<br>
				<a href="javascript:toggle('lessonPlans')" target="_top" onclick="MM_nbGroup(&#39;down&#39;,&#39;group1&#39;,&#39;plans&#39;,&#39;&#39;,1)">Close this Window</a>
				</div></body></html>
